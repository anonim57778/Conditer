"use client"
import { useState } from "react";
import { useCartStore } from "~/app/store/cart-store";
import { Button } from "~/components/ui/button";
import { type Product } from "~/lib/shared/types/product";
import { cn } from "~/lib/utils";


export default function SelectAmount({
    product
} : {
    product: Product
}) {
    const [currentAmount, setCurrentAmount] = useState<1 | 4 | 8>(1);
    const { cartProducts, addToCart } = useCartStore();

    const currentCartProduct = cartProducts.find((pr) => pr.id === product.id && pr.quantity !== 0);

    return (
        <div className="flex flex-col gap-y-9">
            <div className="flex flex-col gap-y-2">
                <h1 className="font-bold text-xl lg:text-2xl">Выбрать кол-во</h1>

                <div className="grid grid-cols-3 gap-2">
                    {[1, 4, 8].map((amount, index) => (
                        <button key={index} onClick={() => setCurrentAmount(amount as 1 | 4 | 8)} className={cn("flex relative flex-col gap-y-1 lg:gap-y-2 border border-primary rounded-[8px] h-auto bg-background p-2 lg:p-4", currentAmount === amount && "bg-[#C23B42]/5")}>
                            <h1 className="text-xl font-medium lg:text-2xl">{amount} - штуки</h1>
                            <h1 className="font-bold text-base lg:text-xl">{amount == 1 ? product.priceFor1 : amount == 4 ? product.priceFor4 : product.priceFor8}₽</h1>

                            {amount == 8 && (
                                <svg
                                    className={"absolute -right-1/4 -top-1/2 transition"}
                                    width="80"
                                    height="80"
                                    viewBox="0 0 80 80"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                        d="M35.7292 4.27084C38.0879 1.91212 41.9121 1.91212 44.2708 4.27084L75.7292 35.7292C78.0879 38.0879 78.0879 41.9121 75.7292 44.2708L44.2708 75.7292C41.9121 78.0879 38.0879 78.0879 35.7292 75.7292L4.27084 44.2708C1.91212 41.9121 1.91212 38.0879 4.27084 35.7292L35.7292 4.27084Z"
                                        fill="#C23B42"
                                    />
                                    <path
                                        d="M17.7116 36.9933H14.4343V30.3743H18.6631V31.2706H15.3306V32.7415H17.7116C18.2387 32.7415 18.6999 32.9131 19.0952 33.2563C19.325 33.4524 19.5058 33.6899 19.6376 33.9688C19.7694 34.2476 19.8353 34.5479 19.8353 34.8697C19.8353 35.1915 19.7694 35.4918 19.6376 35.7706C19.5058 36.0464 19.325 36.2824 19.0952 36.4785C18.6999 36.8217 18.2387 36.9933 17.7116 36.9933ZM17.7116 36.1016C18.0518 36.1016 18.3414 35.9821 18.5804 35.7431C18.8225 35.501 18.9435 35.2099 18.9435 34.8697C18.9435 34.5296 18.8225 34.24 18.5804 34.001C18.3414 33.7589 18.0518 33.6378 17.7116 33.6378H15.3306V36.1016H17.7116ZM23.2183 37.0623C22.7893 37.0623 22.3986 36.9581 22.0462 36.7497C21.6938 36.5413 21.4119 36.2609 21.2004 35.9085C20.9921 35.5531 20.8879 35.1639 20.8879 34.741C20.8879 34.312 20.9921 33.9213 21.2004 33.5689C21.4119 33.2165 21.6938 32.9361 22.0462 32.7277C22.3986 32.5163 22.7893 32.4106 23.2183 32.4106C23.6136 32.4106 23.9783 32.5025 24.3123 32.6863C24.6494 32.8671 24.9236 33.1138 25.1351 33.4264C25.3496 33.7359 25.4798 34.0898 25.5258 34.4882L25.535 34.7364L25.5212 35.1823H21.8394C21.87 35.3753 22.0156 35.5883 22.276 35.8212C22.5396 36.0541 22.8537 36.1705 23.2183 36.1705C23.5677 36.1705 23.9262 36.0142 24.2939 35.7017L24.919 36.336C24.5973 36.6179 24.3062 36.8095 24.0457 36.9106C23.7852 37.0117 23.5094 37.0623 23.2183 37.0623ZM24.5927 34.2905C24.562 34.0975 24.415 33.886 24.1514 33.6562C23.8879 33.4233 23.5753 33.3069 23.2137 33.3069C22.8552 33.3069 22.5426 33.4233 22.276 33.6562C22.0125 33.886 21.8654 34.0975 21.8348 34.2905H24.5927ZM28.6652 37.0623C28.2393 37.0623 27.8501 36.9581 27.4977 36.7497C27.1453 36.5413 26.8634 36.2609 26.6519 35.9085C26.4436 35.5561 26.3394 35.1654 26.3394 34.7364C26.3394 34.3105 26.4436 33.9213 26.6519 33.5689C26.8634 33.2165 27.1453 32.9361 27.4977 32.7277C27.8501 32.5163 28.2393 32.4106 28.6652 32.4106C28.987 32.4106 29.2888 32.4718 29.5708 32.5944C29.8527 32.7139 30.1499 32.93 30.4625 33.2425L29.8282 33.8769C29.5953 33.644 29.393 33.4907 29.2214 33.4172C29.0498 33.3437 28.8644 33.3069 28.6652 33.3069C28.4017 33.3069 28.1611 33.3712 27.9436 33.4999C27.7291 33.6286 27.5575 33.8018 27.4288 34.0193C27.3001 34.2339 27.2357 34.4729 27.2357 34.7364C27.2357 34.9999 27.3001 35.2405 27.4288 35.4581C27.5575 35.6726 27.7291 35.8457 27.9436 35.9775C28.1611 36.1062 28.4017 36.1705 28.6652 36.1705C28.8644 36.1705 29.0498 36.1338 29.2214 36.0602C29.3961 35.9836 29.5999 35.8289 29.8328 35.596L30.4671 36.2257C30.1514 36.5413 29.8527 36.7604 29.5708 36.883C29.2888 37.0025 28.987 37.0623 28.6652 37.0623ZM35.4314 36.9933H34.535V33.3712H32.2919V36.9933H31.3956V32.4749H35.4314V36.9933ZM36.4748 36.9887C36.4717 36.9918 36.4702 36.6945 36.4702 36.097C36.7123 36.097 36.8701 36.0602 36.9436 35.9867C37.0202 35.9101 37.0585 35.8227 37.0585 35.7247V34.7318C37.0585 34.1894 37.2286 33.7129 37.5688 33.3023C37.7434 33.0878 37.9503 32.9131 38.1893 32.7783C38.5294 32.573 38.9048 32.4703 39.3154 32.4703H40.6347V36.9887H39.7429V33.3666H39.3108C39.0565 33.3697 38.8267 33.4325 38.6214 33.5551C38.4191 33.6777 38.2567 33.8416 38.1341 34.0469C38.0116 34.2522 37.9503 34.4805 37.9503 34.7318C37.9503 34.9341 37.9518 35.0766 37.9549 35.1593C37.961 35.239 37.9641 35.3186 37.9641 35.3983C37.9641 35.5699 37.9472 35.7676 37.9135 35.9913C37.8828 36.215 37.7618 36.4325 37.5504 36.644C37.4309 36.7574 37.2945 36.8447 37.1413 36.906C37.1229 36.909 37.0922 36.9167 37.0493 36.929C37.0095 36.9382 36.962 36.9489 36.9068 36.9611C36.8548 36.9765 36.8073 36.9857 36.7644 36.9887H36.4748ZM43.9901 37.0623C43.5642 37.0623 43.175 36.9581 42.8226 36.7497C42.4702 36.5413 42.1883 36.2609 41.9768 35.9085C41.7685 35.5561 41.6643 35.1654 41.6643 34.7364C41.6643 34.3074 41.7685 33.9182 41.9768 33.5689C42.1883 33.2165 42.4702 32.9361 42.8226 32.7277C43.175 32.5163 43.5642 32.4106 43.9901 32.4106C44.3303 32.4106 44.6551 32.4826 44.9646 32.6266C45.2772 32.7706 45.5438 32.9729 45.7644 33.2333C45.9452 33.4509 46.08 33.6853 46.1689 33.9366C46.2578 34.1879 46.3129 34.4484 46.3344 34.718L46.5412 36.9979H45.6403L45.6127 36.5337L45.6173 36.5245C45.6173 36.5214 45.6142 36.5199 45.6081 36.5199C45.5744 36.5199 45.4013 36.6103 45.0887 36.7911C44.7761 36.9719 44.41 37.0623 43.9901 37.0623ZM43.9901 36.1705C44.2537 36.1705 44.4942 36.1062 44.7118 35.9775C44.9294 35.8457 45.1025 35.6726 45.2312 35.4581C45.3599 35.2405 45.4243 34.9999 45.4243 34.7364C45.4243 34.4729 45.3599 34.2339 45.2312 34.0193C45.1025 33.8018 44.9294 33.6286 44.7118 33.4999C44.4942 33.3712 44.2537 33.3069 43.9901 33.3069C43.7266 33.3069 43.486 33.3712 43.2685 33.4999C43.054 33.6286 42.8824 33.8018 42.7537 34.0193C42.625 34.2339 42.5606 34.4729 42.5606 34.7364C42.5606 34.9999 42.625 35.2405 42.7537 35.4581C42.8824 35.6726 43.054 35.8457 43.2685 35.9775C43.486 36.1062 43.7266 36.1705 43.9901 36.1705ZM49.9105 36.9933H49.0188V33.3712H47.4467V32.4749H51.4825V33.3712H49.9105V36.9933ZM56.0699 36.9933H55.1735V34.9524H52.9304V36.9933H52.0341V32.4749H52.9304V34.0561H55.1735V32.4749H56.0699V36.9933ZM59.3886 37.0623C58.9626 37.0623 58.5735 36.9581 58.2211 36.7497C57.8687 36.5413 57.5867 36.2609 57.3753 35.9085C57.1669 35.5561 57.0627 35.1654 57.0627 34.7364C57.0627 34.3074 57.1669 33.9182 57.3753 33.5689C57.5867 33.2165 57.8687 32.9361 58.2211 32.7277C58.5735 32.5163 58.9626 32.4106 59.3886 32.4106C59.7287 32.4106 60.0536 32.4826 60.3631 32.6266C60.6756 32.7706 60.9422 32.9729 61.1629 33.2333C61.3437 33.4509 61.4785 33.6853 61.5673 33.9366C61.6562 34.1879 61.7114 34.4484 61.7328 34.718L61.9397 36.9979H61.0387L61.0112 36.5337L61.0158 36.5245C61.0158 36.5214 61.0127 36.5199 61.0066 36.5199C60.9729 36.5199 60.7997 36.6103 60.4872 36.7911C60.1746 36.9719 59.8084 37.0623 59.3886 37.0623ZM59.3886 36.1705C59.6521 36.1705 59.8927 36.1062 60.1102 35.9775C60.3278 35.8457 60.5009 35.6726 60.6297 35.4581C60.7584 35.2405 60.8227 34.9999 60.8227 34.7364C60.8227 34.4729 60.7584 34.2339 60.6297 34.0193C60.5009 33.8018 60.3278 33.6286 60.1102 33.4999C59.8927 33.3712 59.6521 33.3069 59.3886 33.3069C59.125 33.3069 58.8845 33.3712 58.6669 33.4999C58.4524 33.6286 58.2808 33.8018 58.1521 34.0193C58.0234 34.2339 57.9591 34.4729 57.9591 34.7364C57.9591 34.9999 58.0234 35.2405 58.1521 35.4581C58.2808 35.6726 58.4524 35.8457 58.6669 35.9775C58.8845 36.1062 59.125 36.1705 59.3886 36.1705ZM66.7109 36.9933H65.8146V35.55H64.9412L63.9346 36.9933H62.8452L63.8932 35.4856L63.907 35.4627C63.6036 35.334 63.3615 35.1378 63.1807 34.8743C62.9999 34.6108 62.9095 34.3227 62.9095 34.0102C62.9095 33.6302 63.0337 33.2977 63.2819 33.0127C63.4228 32.8472 63.5929 32.717 63.7921 32.622C63.9943 32.5239 64.2134 32.4749 64.4494 32.4749H66.7109V36.9933ZM65.8146 34.6537V33.3712H64.4494C64.2717 33.3712 64.12 33.4341 63.9943 33.5597C63.8687 33.6853 63.8059 33.8355 63.8059 34.0102C63.8059 34.1879 63.8687 34.3396 63.9943 34.4652C64.12 34.5909 64.2717 34.6537 64.4494 34.6537H65.8146ZM25.5626 49.9908H24.6662V48.9933H19.8398V49.9908H18.9435V48.1016H19.5962C19.8291 47.9085 20.0237 47.6527 20.18 47.334C20.3363 47.0122 20.4144 46.6644 20.4144 46.2905V42.3743H24.6478V48.1016H25.5626V49.9908ZM23.7515 48.1016V43.2706H21.3107V46.2905C21.3107 47.1179 21.1453 47.7216 20.8143 48.1016H23.7515ZM28.7434 49.0623C28.3174 49.0623 27.9282 48.9581 27.5758 48.7497C27.2234 48.5413 26.9415 48.2609 26.7301 47.9085C26.5217 47.5561 26.4175 47.1654 26.4175 46.7364C26.4175 46.3074 26.5217 45.9182 26.7301 45.5689C26.9415 45.2165 27.2234 44.9361 27.5758 44.7277C27.9282 44.5163 28.3174 44.4106 28.7434 44.4106C29.1724 44.4106 29.5631 44.5163 29.9155 44.7277C30.2679 44.9361 30.5483 45.2165 30.7567 45.5689C30.9681 45.9182 31.0738 46.3074 31.0738 46.7364C31.0738 47.1654 30.9681 47.5561 30.7567 47.9085C30.5483 48.2609 30.2679 48.5413 29.9155 48.7497C29.5631 48.9581 29.1724 49.0623 28.7434 49.0623ZM28.7434 48.1705C29.0069 48.1705 29.2475 48.1062 29.465 47.9775C29.6826 47.8457 29.8557 47.6726 29.9844 47.4581C30.1131 47.2405 30.1775 46.9999 30.1775 46.7364C30.1775 46.4729 30.1131 46.2339 29.9844 46.0193C29.8557 45.8018 29.6826 45.6286 29.465 45.4999C29.2475 45.3712 29.0069 45.3069 28.7434 45.3069C28.4798 45.3069 28.2393 45.3712 28.0217 45.4999C27.8072 45.6286 27.6356 45.8018 27.5069 46.0193C27.3782 46.2339 27.3138 46.4729 27.3138 46.7364C27.3138 46.9999 27.3782 47.2405 27.5069 47.4581C27.6356 47.6726 27.8072 47.8457 28.0217 47.9775C28.2393 48.1062 28.4798 48.1705 28.7434 48.1705ZM34.296 49.0623C33.8701 49.0623 33.4809 48.9581 33.1285 48.7497C32.7761 48.5413 32.4942 48.2609 32.2827 47.9085C32.0743 47.5561 31.9701 47.1654 31.9701 46.7364C31.9701 46.3105 32.0743 45.9213 32.2827 45.5689C32.4942 45.2165 32.7761 44.9361 33.1285 44.7277C33.4809 44.5163 33.8701 44.4106 34.296 44.4106C34.6178 44.4106 34.9196 44.4718 35.2015 44.5944C35.4834 44.7139 35.7807 44.93 36.0933 45.2425L35.4589 45.8769C35.226 45.644 35.0238 45.4907 34.8522 45.4172C34.6806 45.3437 34.4952 45.3069 34.296 45.3069C34.0325 45.3069 33.7919 45.3712 33.5743 45.4999C33.3598 45.6286 33.1882 45.8018 33.0595 46.0193C32.9308 46.2339 32.8665 46.4729 32.8665 46.7364C32.8665 46.9999 32.9308 47.2405 33.0595 47.4581C33.1882 47.6726 33.3598 47.8457 33.5743 47.9775C33.7919 48.1062 34.0325 48.1705 34.296 48.1705C34.4952 48.1705 34.6806 48.1338 34.8522 48.0602C35.0269 47.9836 35.2306 47.8289 35.4635 47.596L36.0979 48.2257C35.7822 48.5413 35.4834 48.7604 35.2015 48.883C34.9196 49.0025 34.6178 49.0623 34.296 49.0623ZM39.4901 48.9933H38.5984V45.3712H37.0264V44.4749H41.0621V45.3712H39.4901V48.9933ZM43.9396 49.0623C43.5136 49.0623 43.1244 48.9581 42.772 48.7497C42.4196 48.5413 42.1377 48.2609 41.9263 47.9085C41.7179 47.5561 41.6137 47.1654 41.6137 46.7364C41.6137 46.3074 41.7179 45.9182 41.9263 45.5689C42.1377 45.2165 42.4196 44.9361 42.772 44.7277C43.1244 44.5163 43.5136 44.4106 43.9396 44.4106C44.2797 44.4106 44.6045 44.4826 44.914 44.6266C45.2266 44.7706 45.4932 44.9729 45.7138 45.2333C45.8946 45.4509 46.0295 45.6853 46.1183 45.9366C46.2072 46.1879 46.2624 46.4484 46.2838 46.718L46.4907 48.9979H45.5897L45.5622 48.5337L45.5668 48.5245C45.5668 48.5214 45.5637 48.5199 45.5576 48.5199C45.5238 48.5199 45.3507 48.6103 45.0381 48.7911C44.7256 48.9719 44.3594 49.0623 43.9396 49.0623ZM43.9396 48.1705C44.2031 48.1705 44.4437 48.1062 44.6612 47.9775C44.8788 47.8457 45.0519 47.6726 45.1806 47.4581C45.3093 47.2405 45.3737 46.9999 45.3737 46.7364C45.3737 46.4729 45.3093 46.2339 45.1806 46.0193C45.0519 45.8018 44.8788 45.6286 44.6612 45.4999C44.4437 45.3712 44.2031 45.3069 43.9396 45.3069C43.676 45.3069 43.4355 45.3712 43.2179 45.4999C43.0034 45.6286 42.8318 45.8018 42.7031 46.0193C42.5744 46.2339 42.51 46.4729 42.51 46.7364C42.51 46.9999 42.5744 47.2405 42.7031 47.4581C42.8318 47.6726 43.0034 47.8457 43.2179 47.9775C43.4355 48.1062 43.676 48.1705 43.9396 48.1705ZM49.9381 48.9933H47.3962V44.4749H49.6439C49.8584 44.4749 50.053 44.527 50.2277 44.6312C50.4054 44.7354 50.5463 44.8733 50.6505 45.0449C50.7609 45.2257 50.816 45.4264 50.816 45.647C50.816 45.9014 50.793 46.0607 50.7471 46.1251C50.8175 46.1526 50.9371 46.2645 51.1056 46.4606C51.3507 46.7456 51.4733 47.0781 51.4733 47.4581C51.4733 47.838 51.3507 48.1705 51.1056 48.4555C50.9616 48.621 50.7884 48.7528 50.5862 48.8508C50.387 48.9458 50.171 48.9933 49.9381 48.9933ZM49.6439 45.9228C49.7205 45.9228 49.7864 45.8968 49.8415 45.8447C49.8967 45.7895 49.9243 45.7236 49.9243 45.647C49.9243 45.5704 49.8967 45.5061 49.8415 45.454C49.7864 45.3988 49.7205 45.3712 49.6439 45.3712H48.2925V45.9228H49.6439ZM49.9381 48.1016C50.1127 48.1016 50.2629 48.0388 50.3885 47.9131C50.5142 47.7875 50.577 47.6358 50.577 47.4581C50.577 47.2803 50.5142 47.1302 50.3885 47.0076C50.2629 46.882 50.1127 46.8191 49.9381 46.8191H48.2925V48.1016H49.9381ZM56.41 48.9933C55.8523 48.9933 55.4018 48.8922 55.0586 48.6899C54.7185 48.4846 54.4458 48.2119 54.2404 47.8718C54.0382 47.5316 53.934 47.2206 53.9279 46.9387C53.888 46.9478 53.6705 46.9524 53.2752 46.9524H53.2384V48.9933H52.3421V44.4749H53.2384V46.0561H53.6337C53.885 46.0561 54.1133 45.9948 54.3186 45.8723C54.527 45.7497 54.6909 45.5857 54.8104 45.3804C54.933 45.172 54.9943 44.8702 54.9943 44.4749H55.8952C55.8952 45.1644 55.7236 45.7144 55.3804 46.1251C55.1935 46.3518 55.0096 46.5142 54.8288 46.6123L54.8334 46.7318C54.8334 46.9862 54.8947 47.216 55.0173 47.4213C55.1429 47.6266 55.3084 47.7921 55.5137 47.9177C55.719 48.0403 56.0178 48.1016 56.41 48.1016V48.9933ZM59.4667 49.0623C59.0408 49.0623 58.6516 48.9581 58.2992 48.7497C57.9468 48.5413 57.6649 48.2609 57.4534 47.9085C57.2451 47.5561 57.1409 47.1654 57.1409 46.7364C57.1409 46.3074 57.2451 45.9182 57.4534 45.5689C57.6649 45.2165 57.9468 44.9361 58.2992 44.7277C58.6516 44.5163 59.0408 44.4106 59.4667 44.4106C59.8069 44.4106 60.1317 44.4826 60.4412 44.6266C60.7538 44.7706 61.0204 44.9729 61.241 45.2333C61.4218 45.4509 61.5566 45.6853 61.6455 45.9366C61.7344 46.1879 61.7895 46.4484 61.811 46.718L62.0178 48.9979H61.1169L61.0893 48.5337L61.0939 48.5245C61.0939 48.5214 61.0908 48.5199 61.0847 48.5199C61.051 48.5199 60.8779 48.6103 60.5653 48.7911C60.2527 48.9719 59.8865 49.0623 59.4667 49.0623ZM59.4667 48.1705C59.7303 48.1705 59.9708 48.1062 60.1884 47.9775C60.406 47.8457 60.5791 47.6726 60.7078 47.4581C60.8365 47.2405 60.9008 46.9999 60.9008 46.7364C60.9008 46.4729 60.8365 46.2339 60.7078 46.0193C60.5791 45.8018 60.406 45.6286 60.1884 45.4999C59.9708 45.3712 59.7303 45.3069 59.4667 45.3069C59.2032 45.3069 58.9626 45.3712 58.7451 45.4999C58.5306 45.6286 58.359 45.8018 58.2303 46.0193C58.1015 46.2339 58.0372 46.4729 58.0372 46.7364C58.0372 46.9999 58.1015 47.2405 58.2303 47.4581C58.359 47.6726 58.5306 47.8457 58.7451 47.9775C58.9626 48.1062 59.2032 48.1705 59.4667 48.1705Z"
                                        fill="#EFE5DC"
                                    />
                                </svg>
                            )}

                        </button>
                    ))}
                </div>
            </div>
            <Button
                onClick={() => {
                    if (currentCartProduct) {
                        addToCart(product.id, 0);
                    } else {
                        addToCart(product.id, currentAmount);
                    }
                }}
            >
                {currentCartProduct ? "Удалить из корзины" : "Добавить в корзину"}
            </Button>
        </div>
    )
}